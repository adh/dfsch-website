<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>dfsch: dfsch/serdes.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">dfsch
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('serdes_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">dfsch/serdes.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="serdes_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef H__dfsch__serdes__</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define H__dfsch__serdes__</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;<a class="code" href="dfsch_8h.html">dfsch/dfsch.h</a>&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;<a class="code" href="strings_8h.html">dfsch/strings.h</a>&gt;</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="keyword">extern</span> <a class="code" href="structdfsch__type__t.html">dfsch_type_t</a> <a class="code" href="serdes_8h.html#aa4a39cf40fc96a370ac864dfadc3cf7a">dfsch_serializer_type</a>;
<a name="l00008"></a><a class="code" href="serdes_8h.html#aeb193065c63bfe8c12063da9dd01d783">00008</a> <span class="preprocessor">#define DFSCH_SERIALIZER_TYPE (&amp;dfsch_serializer_type)</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 <a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* <a class="code" href="serdes_8h.html#a5aaa13a93a204115974cd989a90385f5">dfsch_make_serializer</a>(<a class="code" href="types_8h.html#a34f8494fe751f6a59577dc48f1ed9d91">dfsch_output_proc_t</a> op,
<a name="l00011"></a>00011                                           <span class="keywordtype">void</span>* baton);
<a name="l00012"></a>00012 <a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* <a class="code" href="serdes_8h.html#ad5d9a243b175e534f3804df93746ea4d">dfsch_serializer</a>(<a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* obj);
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#a6e056e765cdca94e64d05ffbc9377d3e">dfsch_serializer_write_stream_header</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00015"></a>00015                                           <span class="keywordtype">char</span>* format);
<a name="l00016"></a>00016 
<a name="l00017"></a>00017 <span class="keywordtype">int</span> <a class="code" href="serdes_8h.html#a4fd0fcb742a1e09e01c6bff6c10fd617">dfsch_type_serializable_p</a>(<a class="code" href="structdfsch__type__t.html">dfsch_type_t</a>* type);
<a name="l00018"></a>00018 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#ae29c8c380c6166f13f7c9c2d306a4afa">dfsch_serialize_object</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00019"></a>00019                             <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* obj);
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#af46785d36e52a329171db09ad61994bf">dfsch_serialize_integer</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00022"></a>00022                              int64_t i);
<a name="l00023"></a>00023 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#aa4677ea014db0d940519c7e83bb98819">dfsch_serialize_strbuf</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00024"></a>00024                             <a class="code" href="structdfsch__strbuf__t.html">dfsch_strbuf_t</a>* sb);
<a name="l00025"></a>00025 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#a8600c95eaa6a931b0199d4d05f57dedf">dfsch_serialize_cstr</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00026"></a>00026                           <span class="keywordtype">char</span>* str);
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#a0a8a9e9cb09e5171e4b9cf4c2e6ada52">dfsch_serialize_string</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00029"></a>00029                             <span class="keywordtype">char</span>* str, <span class="keywordtype">size_t</span> len);
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#aa9850deccf2355f313a3dccd0fefcec3">dfsch_serialize_stream_symbol</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00032"></a>00032                                    <span class="keywordtype">char</span>* sym);
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">typedef</span> 
<a name="l00035"></a><a class="code" href="serdes_8h.html#a29f507b908a55f494e6b63bcb0d7871f">00035</a> int (*<a class="code" href="serdes_8h.html#a29f507b908a55f494e6b63bcb0d7871f">dfsch_serializer_object_hook_t</a>)(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* serializer,
<a name="l00036"></a>00036                                               <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* obj,
<a name="l00037"></a>00037                                               <span class="keywordtype">void</span>* baton);
<a name="l00038"></a>00038 <span class="keyword">typedef</span> 
<a name="l00039"></a><a class="code" href="serdes_8h.html#a34954682da376b2ce733bae9db106391">00039</a> int (*<a class="code" href="serdes_8h.html#a34954682da376b2ce733bae9db106391">dfsch_serializer_unserializable_hook_t</a>)(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* serializer,
<a name="l00040"></a>00040                                               <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* obj,
<a name="l00041"></a>00041                                               <span class="keywordtype">void</span>* baton);
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#a43b8c0bc068fbf51591dc904e5f4dede">dfsch_serializer_set_object_hook</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00044"></a>00044                                       <a class="code" href="serdes_8h.html#a29f507b908a55f494e6b63bcb0d7871f">dfsch_serializer_object_hook_t</a> h,
<a name="l00045"></a>00045                                       <span class="keywordtype">void</span> *baton);
<a name="l00046"></a>00046 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#a0cada3749518225c1798d80fbbce1b92">dfsch_serializer_set_unserializable_hook</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00047"></a>00047                                               <a class="code" href="serdes_8h.html#a34954682da376b2ce733bae9db106391">dfsch_serializer_unserializable_hook_t</a> h,
<a name="l00048"></a>00048                                               <span class="keywordtype">void</span>* baton);
<a name="l00049"></a>00049 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#ac18b671f6c3deb021d0bff7e7b322d72">dfsch_serializer_set_canonical_environment</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00050"></a>00050                                                 <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* env);
<a name="l00051"></a>00051 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#a3cbda3df26d491429a4ece2025ff2862">dfsch_serializer_set_compress</a>(<a class="code" href="types_8h.html#a3c2ee10e93e66aef8690b7125b4034b5">dfsch_serializer_t</a>* s,
<a name="l00052"></a>00052                                    <span class="keywordtype">int</span> compress);
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 <span class="keyword">extern</span> <a class="code" href="structdfsch__type__t.html">dfsch_type_t</a> <a class="code" href="serdes_8h.html#a3d28c20c8721474e889ae819fe57b159">dfsch_deserializer_type</a>;
<a name="l00055"></a><a class="code" href="serdes_8h.html#ab48c97f85cc0fcf7cd3fda90ea20c8a6">00055</a> <span class="preprocessor">#define DFSCH_DESERIALIZER_TYPE (&amp;dfsch_deserializer_type)</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span>
<a name="l00057"></a><a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">00057</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a> <a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>;
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* <a class="code" href="serdes_8h.html#a4f5764dd563ce35870fd5cae9116c308">dfsch_make_deserializer</a>(<a class="code" href="types_8h.html#aebfe9ed4875f4366c183af7076d4cbe6">dfsch_input_proc_t</a> ip,
<a name="l00060"></a>00060                                               <span class="keywordtype">void</span>* baton);
<a name="l00061"></a>00061 <a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* <a class="code" href="serdes_8h.html#a38c8f5d59a39e681e1f2a765cfe7ae00">dfsch_deserializer</a>(<a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* obj);
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#ac952eb3ba995cbc5b95c519439b4db4c">dfsch_deserializer_read_stream_header</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds,
<a name="l00064"></a>00064                                            <span class="keywordtype">char</span>* fmt);
<a name="l00065"></a>00065 
<a name="l00066"></a>00066 <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* <a class="code" href="serdes_8h.html#ac5052bd2e52736c4549a364fb8484a38">dfsch_deserialize_object</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds);
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 int64_t <a class="code" href="serdes_8h.html#a8b406e4b3c6c035e34332a79b7ba7e47">dfsch_deserialize_integer</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds);
<a name="l00069"></a>00069 <a class="code" href="structdfsch__strbuf__t.html">dfsch_strbuf_t</a>* <a class="code" href="serdes_8h.html#a3c1e660d90fac6302ef6e074f107355e">dfsch_deserialize_strbuf</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds);
<a name="l00070"></a>00070 <span class="keywordtype">char</span>* <a class="code" href="serdes_8h.html#ac380aaf8bf78c4ff448068de3b1031ae">dfsch_deserialize_stream_symbol</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds);
<a name="l00071"></a>00071 
<a name="l00072"></a>00072 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#a5982ba9208d1739c661ace43ec83b376">dfsch_deserializer_put_partial_object</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds,
<a name="l00073"></a>00073                                            <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* obj);
<a name="l00074"></a>00074 <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>** <a class="code" href="serdes_8h.html#ad9db8957982a830e8d547ed330b6b725">dfsch_deserializer__skip_object</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds);
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 <span class="keyword">typedef</span> 
<a name="l00077"></a><a class="code" href="serdes_8h.html#a336d52a35923a431a0af97e2afb85704">00077</a> <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* (*dfsch_deserializer_unknown_hook_t)(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds,
<a name="l00078"></a>00078                                                      <span class="keywordtype">char</span>* name,
<a name="l00079"></a>00079                                                      <span class="keywordtype">void</span>* baton);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#afe372f5b3741995b5114be255fa394d4">dfsch_deserializer_set_unknown_hook</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds,
<a name="l00082"></a>00082                                          <a class="code" href="serdes_8h.html#a336d52a35923a431a0af97e2afb85704">dfsch_deserializer_unknown_hook_t</a> h,
<a name="l00083"></a>00083                                          <span class="keywordtype">void</span>* baton);
<a name="l00084"></a>00084 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#a900c64c2292fbcaac72ddaa3c2b4b164">dfsch_deserializer_set_canonical_environment</a>(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds,
<a name="l00085"></a>00085                                                   <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* env);
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="serdes_8h.html#a4860fde45739d464cdce6cdf3734eb4f">00087</a> <span class="keyword">typedef</span> <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* (*dfsch_deserializer_handler_t)(<a class="code" href="serdes_8h.html#a02c534947bb5556179ea98e3d33cad37">dfsch_deserializer_t</a>* ds);
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="keywordtype">void</span> <a class="code" href="serdes_8h.html#ae9d52109a91716da45928acb51b1f55b">dfsch_register_deserializer_handler</a>(<span class="keywordtype">char</span>* name,
<a name="l00090"></a>00090                                          <a class="code" href="serdes_8h.html#a4860fde45739d464cdce6cdf3734eb4f">dfsch_deserializer_handler_t</a> h);
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="serdes_8h.html#ada501c5ecfded98fa7a86f422b6ebd7b">00092</a> <span class="preprocessor">#define DFSCH_DEFINE_DESERIALIZATION_HANDLER(name, cname)\</span>
<a name="l00093"></a>00093 <span class="preprocessor">  static dfsch_object_t* deshandler_##cname(dfsch_deserializer_t* ds);  \</span>
<a name="l00094"></a>00094 <span class="preprocessor">  static void __attribute__((constructor)) dhcons__##cname(){       \</span>
<a name="l00095"></a>00095 <span class="preprocessor">    dfsch_register_deserializer_handler(name, deshandler_##cname);      \</span>
<a name="l00096"></a>00096 <span class="preprocessor">  }                                                                     \</span>
<a name="l00097"></a>00097 <span class="preprocessor">  static dfsch_object_t* deshandler_##cname(dfsch_deserializer_t* ds)</span>
<a name="l00098"></a>00098 <span class="preprocessor"></span>
<a name="l00099"></a>00099 <span class="comment">/* High-level C interface */</span>
<a name="l00100"></a>00100 
<a name="l00101"></a><a class="code" href="serdes_8h.html#a79a499f96c0ea27a64b9c232c6183156">00101</a> <span class="preprocessor">#define DFSCH_SERIALIZE_COMPRESS  1</span>
<a name="l00102"></a>00102 <span class="preprocessor"></span>
<a name="l00103"></a>00103 <a class="code" href="structdfsch__strbuf__t.html">dfsch_strbuf_t</a>* <a class="code" href="serdes_8h.html#ab2dd466fdca81957267307fd14a160b9">dfsch_serialize</a>(<a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* obj, 
<a name="l00104"></a>00104                                 <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* canon_env,
<a name="l00105"></a>00105                                 <span class="keywordtype">int</span> flags);
<a name="l00106"></a>00106 <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* <a class="code" href="serdes_8h.html#ad16e9551c89774e49e70104105a880be">dfsch_deserialize</a>(<a class="code" href="structdfsch__strbuf__t.html">dfsch_strbuf_t</a>* sb,
<a name="l00107"></a>00107                                   <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* canon_env);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 
<a name="l00110"></a><a class="code" href="serdes_8h.html#a090c5247d8110898c4ed18af1761a5b1">00110</a> <span class="preprocessor">#define DFSCH_SERIALIZER_ARG(al, name) \</span>
<a name="l00111"></a>00111 <span class="preprocessor">  DFSCH_GENERIC_ARG(al, name, dfsch_serializer_t*, dfsch_serializer)</span>
<a name="l00112"></a><a class="code" href="serdes_8h.html#a6d9c91f5df4aaa3898a182ddcca005f4">00112</a> <span class="preprocessor"></span><span class="preprocessor">#define DFSCH_DESERIALIZER_ARG(al, name) \</span>
<a name="l00113"></a>00113 <span class="preprocessor">  DFSCH_GENERIC_ARG(al, name, dfsch_deserializer_t*, dfsch_deserializer)</span>
<a name="l00114"></a>00114 <span class="preprocessor"></span>
<a name="l00115"></a>00115 <span class="keyword">extern</span> <a class="code" href="structdfsch__type__t.html">dfsch_type_t</a> <a class="code" href="serdes_8h.html#ac25b0b4908d7e5b7da8b66e987755229">dfsch_serializing_map_type</a>;
<a name="l00116"></a><a class="code" href="serdes_8h.html#ad808f60f3e948a3956e4d09ca264aa09">00116</a> <span class="preprocessor">#define DFSCH_SERIALIZING_MAP_TYPE (&amp;dfsch_serializing_map_type)</span>
<a name="l00117"></a>00117 <span class="preprocessor"></span>
<a name="l00118"></a>00118 <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* <a class="code" href="serdes_8h.html#a1c52a6b04ca3bb6f2330d758392875c6">dfsch_make_serializing_map</a>(<a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* mapping,
<a name="l00119"></a>00119                                            <a class="code" href="structdfsch__object__t.html">dfsch_object_t</a>* canon_env,
<a name="l00120"></a>00120                                            <span class="keywordtype">int</span> flags);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="serdes_8h.html">serdes.h</a>      </li>

    <li class="footer">Generated on Wed Apr 4 2012 05:50:50 for dfsch by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
